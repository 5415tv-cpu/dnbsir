<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>동네비서 대시보드</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>

<body>

    <main style="background-color: #e0e0e0; min-height: 100vh; padding: 20px; font-weight: 800;">
        <section style="margin-bottom: 30px;">
            <h2 id="greeting" style="color: #1a1a1a; font-size: 1.6rem; font-weight: 900;">반갑습니다, 시민님!<br>동네비서가 대기 중입니다.
            </h2>
        </section>

        <!-- Premium Insight -->
        <div id="premiumContainer">
            <!-- VIP Content (Hidden by default) -->
            <div id="premiumInsight" style="display: none; background-color: #e0e0e0; padding: 0; margin-bottom: 25px;">
                <div
                    style="background: #1a1a1a; color: #d4af37; padding: 10px; text-align: center; font-weight: 900; margin-bottom: 15px; border-radius: 5px;">
                    🌟 PREMIUM INSIGHT
                </div>

                <div style="background-color: #f5f5f5; padding: 20px; border: 3px solid #1a1a1a; border-radius: 10px;">
                    <h3 style="margin-top: 0; font-size: 1.2rem; font-weight: 900;">전국 고랭지 배추 실시간 시세 분석</h3>

                    <div style="background: #fff; padding: 15px; border: 2px solid #1a1a1a; margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span>전국 평균가 (10kg)</span>
                            <span style="font-weight: 900;">38,500원</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; color: #d32f2f;">
                            <span>다음 주 예상 시세</span>
                            <span style="font-weight: 900;">▲ 42,000원 (상승세)</span>
                        </div>
                    </div>

                    <p style="font-size: 0.85rem; line-height: 1.6; margin-bottom: 0;">
                        * 프리미엄 파트너님께만 제공되는 예측 데이터입니다.<br>
                        * **출하 전략:** 다음 주 중반 이후 출하 시 10% 이상의 추가 수익이 예상됩니다.
                    </p>
                </div>
            </div>

            <!-- Teaser Content (Shown by default) -->
            <div id="premiumTeaser" style="background-color: #e0e0e0; padding: 0; margin-bottom: 25px;">
                <div
                    style="background: #ccc; color: #666; padding: 10px; text-align: center; font-weight: 900; margin-bottom: 15px; border-radius: 5px;">
                    🔒 PREMIUM INSIGHT (요약)
                </div>

                <div
                    style="background-color: #f5f5f5; padding: 20px; border: 3px solid #ccc; border-radius: 10px; position: relative; overflow: hidden;">
                    <h3 style="margin-top: 0; font-size: 1.2rem; font-weight: 900; color: #999;">전국 고랭지 배추 실시간 시세 분석
                    </h3>

                    <div
                        style="background: #fff; padding: 15px; border: 2px solid #ccc; margin-bottom: 15px; filter: blur(4px);">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span>전국 평균가 (10kg)</span>
                            <span style="font-weight: 900;">38,500원</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; color: #d32f2f;">
                            <span>다음 주 예상 시세</span>
                            <span style="font-weight: 900;">▲ 42,000원 (상승세)</span>
                        </div>
                    </div>

                    <div
                        style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; background: rgba(255,255,255,0.6); flex-direction: column;">
                        <p style="font-weight: 900; color: #1a1a1a; margin-bottom: 10px;">프리미엄 파트너 전용 정보입니다.</p>
                        <button onclick="openMembership()"
                            style="background: #1a1a1a; color: #fff; padding: 10px 20px; border: none; font-weight: 900; cursor: pointer;">
                            🚀 VIP로 업그레이드하고 전체 보기
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div style="display: flex; flex-direction: column; gap: 20px;">
            <div style="background: #ffffff; padding: 25px; border: 3px solid #1a1a1a; border-radius: 10px;">
                <div style="font-size: 1.2rem; margin-bottom: 10px;">📦 간편 택배 접수</div>
                <p style="font-size: 0.9rem; font-weight: 500; margin-bottom: 15px;">사진만 찍어도 주소를 인식하는 똑똑한 접수</p>
                <button onclick="handleFastRequest('courier')"
                    style="width: 100%; background: #1a1a1a; color: #fff; padding: 15px; font-weight: 900; border: none; cursor: pointer;">접수하러
                    가기</button>
            </div>

            <div style="background: #ffffff; padding: 25px; border: 3px solid #1a1a1a; border-radius: 10px;">
                <div style="font-size: 1.2rem; margin-bottom: 10px;">🍎 우리 동네 장날</div>
                <p style="font-size: 0.9rem; font-weight: 500; margin-bottom: 15px;">이웃 농어민의 신선한 수확물 예약하기</p>
                <button onclick="handleFastRequest('market')"
                    style="width: 100%; background: #1a1a1a; color: #fff; padding: 15px; font-weight: 900; border: none; cursor: pointer;">물건
                    보러 가기</button>
            </div>
        </div>

        <div style="margin-top: 40px; text-align: center;">
            <button onclick="toggleVIP()"
                style="background: #d4af37; color: #1a1a1a; padding: 10px 20px; border: none; border-radius: 20px; font-weight: 900; cursor: pointer;">👑
                VIP 모드 전환 (Simulate)</button>
        </div>
    </main>

    <!-- Membership Modal -->
    <div id="membershipModal"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 2000; justify-content: center; align-items: center; overflow-y: auto;">
        <div
            style="position: relative; background-color: #e0e0e0; padding: 30px; border: 4px solid #1a1a1a; border-radius: 15px; font-weight: 800; color: #1a1a1a; max-width: 550px; line-height: 1.6; margin: 20px;">
            <button onclick="closeMembership()"
                style="position: absolute; top: 10px; right: 10px; background: none; border: none; font-size: 1.5rem; cursor: pointer;">✖️</button>

            <div style="text-align: center; margin-bottom: 25px;">
                <span style="font-size: 0.9rem; letter-spacing: 2px; color: #555;">DONGNE BISEO PREMIUM</span>
                <h2
                    style="font-size: 2rem; font-weight: 900; margin: 5px 0; border-bottom: 3px solid #1a1a1a; padding-bottom: 10px;">
                    상위 1%를 위한<br>비즈니스 파트너십
                </h2>
            </div>

            <div style="margin-bottom: 30px;">
                <div style="display: flex; align-items: flex-start; margin-bottom: 15px;">
                    <span style="font-size: 1.5rem; margin-right: 15px;">📊</span>
                    <div>
                        <strong style="font-size: 1.2rem; display: block;">실시간 전국 시세 및 물동량 예측</strong>
                        <span style="font-size: 0.9rem; color: #333;">남들보다 앞선 출하 전략으로 마진 극대화를 <b>지원</b>합니다.</span>
                    </div>
                </div>

                <div style="display: flex; align-items: flex-start; margin-bottom: 15px;">
                    <span style="font-size: 1.5rem; margin-right: 15px;">⚖️</span>
                    <div>
                        <strong style="font-size: 1.2rem; display: block;">1:1 전담 세무 최적화 리포트</strong>
                        <span style="font-size: 0.9rem; color: #333;">자동 기장을 넘어 심화 절세 컨설팅 데이터를 제공합니다.</span>
                    </div>
                </div>

                <div style="display: flex; align-items: flex-start; margin-bottom: 15px;">
                    <span style="font-size: 1.5rem; margin-right: 15px;">⚡</span>
                    <div>
                        <strong style="font-size: 1.2rem; display: block;">AI 우선 응대 및 예약 우선권</strong>
                        <span style="font-size: 0.9rem; color: #333;">0.1초 초고속 서버 할당으로 대기 시간 없이 즉시 응대합니다.</span>
                    </div>
                </div>

                <div style="display: flex; align-items: flex-start;">
                    <span style="font-size: 1.5rem; margin-right: 15px;">🎁</span>
                    <div>
                        <strong style="font-size: 1.2rem; display: block;">충전 보너스 포인트 +5% 추가 적립</strong>
                        <span style="font-size: 0.9rem; color: #333;">모든 충전 시 일반 회원보다 더 높은 적립 혜택을 드립니다.</span>
                    </div>
                </div>
            </div>

            <button onclick="openPayment()"
                style="width: 100%; background: #fee500; color: #1a1a1a; border: none; padding: 20px; font-size: 1.3rem; font-weight: 900; border-radius: 10px; cursor: pointer; box-shadow: 0 5px 0 #d4c200; display: flex; align-items: center; justify-content: center; gap: 10px;">
                <span>⚡ 카카오/삼성페이로 3초 만에 시작하기</span>
            </button>

            <p style="text-align: center; font-size: 0.8rem; margin-top: 15px; color: #666;">
                * 현재 결제액의 10% 할인이 자동으로 적용됩니다.
            </p>
        </div>
    </div>

    <!-- 로딩 오버레이 -->
    <div id="loadingOverlay">
        <div class="spinner"></div>
        <div style="font-size: 1.2rem; font-weight: 900; color: #1a1a1a;">처리 중입니다...</div>
    </div>

    <script>
        function openPayment() {
            // Mock Payment Flow
            const userChoice = confirm("⚡ [간편 결제 시스템]\n\n가장 빠른 결제 수단을 선택해주세요:\n\n'확인' : 🟡 카카오페이 (추천)\n'취소' : 🔵 삼성페이");

            if (userChoice) {
                alert("🟡 카카오페이로 안전하게 결제되었습니다.\n환영합니다, VIP 파트너님!");
            } else {
                alert("🔵 삼성페이로 안전하게 결제되었습니다.\n환영합니다, VIP 파트너님!");
            }

            closeMembership();

            // Force switch to VIP mode if not already
            const insight = document.getElementById('premiumInsight');
            if (insight.style.display === 'none') {
                toggleVIP();
            }
        }

        function openMembership() {
            document.getElementById('membershipModal').style.display = 'flex';
        }

        function closeMembership() {
            document.getElementById('membershipModal').style.display = 'none';
        }

        function toggleVIP() {
            const insight = document.getElementById('premiumInsight');
            const teaser = document.getElementById('premiumTeaser');
            const greeting = document.getElementById('greeting');

            if (insight.style.display === 'none') {
                // Switch to VIP
                insight.style.display = 'block';
                teaser.style.display = 'none';
                greeting.innerHTML = "반갑습니다, <span style='color: #d4af37;'>VIP 파트너님!</span><br>고급 분석 리포트가 도착했습니다.";
            } else {
                // Switch back to Citizen
                insight.style.display = 'none';
                teaser.style.display = 'block';
                greeting.innerHTML = "반갑습니다, 시민님!<br>동네비서가 대기 중입니다.";
            }
        }

        async function handleFastRequest(type) {
            // 1. 버튼을 누르자마자 즉시 '처리 중' 상태 표시
            document.getElementById('loadingOverlay').style.display = 'flex';

            try {
                // 2. 서버 요청 (타임아웃 3초)
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 3000); // 3초 타임아웃

                // 실제로는 API 엔드포인트가 아직 없으므로 모의(Mock) 지연만 줍니다.
                // const response = await fetch('/api/' + type, { signal: controller.signal });

                await new Promise(resolve => setTimeout(resolve, 800)); // 0.8초 흉내
                clearTimeout(timeoutId);

                // 3. 페이지 이동 (성공 시)
                if (type === 'courier') window.location.href = '/courier';
                if (type === 'market') alert('장터 페이지로 이동합니다 (구현 예정)');

            } catch (error) {
                if (error.name === 'AbortError') {
                    alert("네트워크 상태를 확인 후 다시 시도해주세요. (시간 초과)");
                } else {
                    alert("오류가 발생했습니다: " + error.message);
                }
            } finally {
                document.getElementById('loadingOverlay').style.display = 'none';
            }
        }
    </script>

</body>

</html>